(()=>{function _(){try{let t=input_resolution.value.split("x");return[parseInt(t[0]),parseInt(t[1])]}catch(t){return null}}function b(){let t=_();if(!t)return;let n=t[0]/t[1],o=container.parentElement.getBoundingClientRect();n>1&&o.width/n>o.height||n<1&&o.height*n<o.width||n==1&&o.height*n<o.width?(container.style.width=o.height*n+"px",container.style.height=o.height+"px"):(container.style.width=o.width+"px",container.style.height=o.width/n+"px"),f()}b();new ResizeObserver(b).observe(container.parentElement);input_resolution.addEventListener("input",b);function z(t,n,o){let s=document.createElement(n);return t&&t.appendChild(s),s.className=o,s}function I(t,n=.5){t=t.reduce((e,i)=>e.concat(i),[]);let o=t.length-4,s="M"+[t[0],t[1]];for(let e=0;e<t.length-2;e+=2){let i=e?t[e-2]:t[0],l=e?t[e-1]:t[1],c=t[e+0],r=t[e+1],u=t[e+2],d=t[e+3],A=e!==o?t[e+4]:u,N=e!==o?t[e+5]:d,k=((i-c)**2+(l-r)**2)**.5,B=((c-u)**2+(r-d)**2)**.5,F=((u-A)**2+(d-N)**2)**.5,g=F**n,y=F**(2*n),m=B**n,a=B**(2*n),v=k**n,w=k**(2*n),M=2*w+3*v*m+a,R=2*y+3*g*m+a,p=3*v*(v+m);p>0&&(p=1/p);let h=3*g*(m+g);h>0&&(h=1/h);let x=(-a*i+M*c+w*u)*p,E=(-a*l+M*r+w*d)*p,C=(y*c+R*u-a*A)*h,L=(y*r+R*d-a*N)*h;!x&&!E&&(x=c,E=r),!C&&!L&&(C=u,L=d),s+="C"+[x,E,C,L,u,d]}return s}function f(){let t=X();path.setAttribute("d",I(t,.5));let n=_(),o=n[0]/100,s=n[1]/100;textarea_tree.value=t.map(e=>`${Math.round(e[0]*o)} ${Math.round(e[1]*s)}`).join(`
`)}function X(){return[...container.children].filter(t=>t.className=="node").map(t=>[parseFloat(t.style.left),parseFloat(t.style.top)])}textarea_tree.addEventListener("input",()=>{for(;container.lastChild&&container.lastChild.className=="node";)container.removeChild(container.lastChild);let t=_(),n=t[0]/100,o=t[1]/100,s=textarea_tree.value.split(`
`).map(e=>e.split(" ")).filter(e=>e.length==2).map(e=>[parseFloat(e[0])/n,parseFloat(e[1])/o]);s.forEach(e=>{let i=z(container,"node","node");i.style.left=e[0]+"%",i.style.top=e[1]+"%"}),path.setAttribute("d",I(s,.5))});document.addEventListener("keydown",t=>{t.key=="Control"&&container.classList.toggle("control",!0)});document.addEventListener("keyup",t=>{t.key=="Control"&&container.classList.toggle("control",!1)});container.addEventListener("mousedown",t=>{if(t.target.className=="node"){if(t.ctrlKey){container.removeChild(t.target),f();return}let e=l=>{let c=container.getBoundingClientRect(),r=[(l.clientX-c.left)/c.width,(l.clientY-c.top)/c.height];t.target.style.left=r[0]*100+"%",t.target.style.top=r[1]*100+"%",f()},i=l=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i),e(l)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",i)}if(t.target!=container)return;let n=container.getBoundingClientRect(),o=[(t.clientX-n.left)/n.width,(t.clientY-n.top)/n.height],s=z(container,"node","node");s.style.left=o[0]*100+"%",s.style.top=o[1]*100+"%",f()});})();
